<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Low-discrepancy quadrature &mdash; PyApprox 1.0.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script>window.MathJax = {"tex": {"macros": {"V": ["{\\boldsymbol{#1}}", 1], "mean": ["{\\mathbb{E}\\left[#1\\right]}", 1], "var": ["{\\mathbb{V}\\left[#1\\right]}", 1], "rv": "{z}", "reals": "\\mathbb{R}", "pdf": "\\rho", "rvdom": "\\Gamma", "coloneqq": "\\colon=", "norm": ["{\\lVert #1 \\rVert}", 1], "argmax": ["\\operatorname{argmax}"], "argmin": ["\\operatorname{argmin}"], "covar": ["\\mathbb{C}\\text{ov}\\left[#1,#2\\right]", 2], "corr": ["\\mathbb{C}\\text{or}\\left[#1,#2\\right]", 2], "ai": "\\alpha", "bi": "\\beta", "dx": ["\\;\\mathrm{d}#1", 1]}}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Univariate Gaussian Quadrature" href="plot_gaussian_quadrature.html" />
    <link rel="prev" title="Parameter Sweeps" href="plot_parameter_sweeps.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PyApprox
              <img src="../_static/pyapprox-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Software Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_variables.html">Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_setup_model.html">Model Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_interface.html">Model interfacing</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_parameter_sweeps.html">Parameter Sweeps</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Low-discrepancy quadrature</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#monte-carlo">Monte Carlo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sobol-sequences">Sobol Sequences</a></li>
<li class="toctree-l3"><a class="reference internal" href="#latin-hypercube-designs">Latin Hypercube Designs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_gaussian_quadrature.html">Univariate Gaussian Quadrature</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_barycentric_interpolation.html">Multivariate Lagrange Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_multivariate_piecewise_polynomial_interpolation.html">Multivariate Piecewise Polynomial Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_pde_convergence.html">Convergence studies</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_sparse_grid_uq.html">Sparse Grid Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_paper_demo.html">End-to-End Model Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../auto_tutorials/index.html">Theoretical Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Benchmarks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks.html">Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Reference Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_reference_guide.html">User Reference Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyApprox</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Software Tutorial</a></li>
      <li class="breadcrumb-item active">Low-discrepancy quadrature</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_examples/plot_low_discrepancy_quadrature.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-plot-low-discrepancy-quadrature-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="low-discrepancy-quadrature">
<span id="sphx-glr-auto-examples-plot-low-discrepancy-quadrature-py"></span><h1>Low-discrepancy quadrature<a class="headerlink" href="#low-discrepancy-quadrature" title="Permalink to this heading"></a></h1>
<section id="monte-carlo">
<h2>Monte Carlo<a class="headerlink" href="#monte-carlo" title="Permalink to this heading"></a></h2>
<p>It is often important to quantify statistics of numerical models. Monte Carlo
quadrature is the simplest and most robust method for doing so. For any model
we can compute statistics, such as mean and variance as follows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyapprox</span> <span class="kn">import</span> <span class="n">expdesign</span>
<span class="kn">from</span> <span class="nn">pyapprox.benchmarks</span> <span class="kn">import</span> <span class="n">setup_benchmark</span>
<span class="n">benchmark</span> <span class="o">=</span> <span class="n">setup_benchmark</span><span class="p">(</span><span class="s2">&quot;genz&quot;</span><span class="p">,</span> <span class="n">test_name</span><span class="o">=</span><span class="s2">&quot;oscillatory&quot;</span><span class="p">,</span> <span class="n">nvars</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">nsamples</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">mc_samples</span> <span class="o">=</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">nsamples</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">fun</span><span class="p">(</span><span class="n">mc_samples</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">variance</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;variance&quot;</span><span class="p">,</span> <span class="n">variance</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>mean [-0.49820729]
variance [0.03984726]
</pre></div>
</div>
<p>Although not necessary for this scalar valued function, we in geenral must
use the args axis=0 to mean and variance so that we compute the statistics
for each quantity of interest (column of values)</p>
</section>
<section id="sobol-sequences">
<h2>Sobol Sequences<a class="headerlink" href="#sobol-sequences" title="Permalink to this heading"></a></h2>
<p>Large number of samples are needed to compute statistics using Monte Carlo
quadrature. Low-discrepancy sequences can be used to improve accuracy for a
fixed number of samples. We can compute statistics using Sobol sequences as
follows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sobol_samples</span> <span class="o">=</span> <span class="n">expdesign</span><span class="o">.</span><span class="n">sobol_sequence</span><span class="p">(</span>
    <span class="n">benchmark</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">num_vars</span><span class="p">(),</span> <span class="n">nsamples</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">benchmark</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">fun</span><span class="p">(</span><span class="n">sobol_samples</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyapprox.variables</span> <span class="kn">import</span> <span class="n">print_statistics</span>
<span class="n">print_statistics</span><span class="p">(</span><span class="n">sobol_samples</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>           z0         z1         y0
count  100.000000 100.000000 100.000000
mean     0.494063   0.497812  -0.464285
std      0.288799   0.288344   0.198696
min      0.000000   0.000000  -0.837224
max      0.992188   0.992188   0.000000
</pre></div>
</div>
<p>Here we have used print statistics to compute the sample stats. Note,
the inverse cumulative distribution functions of the univariate variables in
variable are used to ensure that the samples integrate with respect to the
joint distribution of variable. If the variable argument is not provided the
Sobol sequence will be generated on the unit hybercube <span class="math notranslate nohighlight">\([0,1]^D\)</span>.</p>
<p>Low-discrepancy sequences are typically more evenly space over the parameter
space. This can be seen by comparing the Monte Carlo and Sobol sequence samples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyapprox.util.configure_plots</span> <span class="kn">import</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mc_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">mc_samples</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MC&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sobol_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">sobol_samples</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;rs&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sobol&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#</span>
<span class="c1">#Halton Sequences</span>
<span class="c1">#================</span>
<span class="c1">#Pyapprox also supports Halton Sequences</span>
<span class="n">halton_samples</span> <span class="o">=</span> <span class="n">expdesign</span><span class="o">.</span><span class="n">halton_sequence</span><span class="p">(</span>
    <span class="n">benchmark</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">num_vars</span><span class="p">(),</span> <span class="n">nsamples</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">benchmark</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">fun</span><span class="p">(</span><span class="n">halton_samples</span><span class="p">)</span>
<span class="n">print_statistics</span><span class="p">(</span><span class="n">halton_samples</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_low_discrepancy_quadrature_001.png" srcset="../_images/sphx_glr_plot_low_discrepancy_quadrature_001.png" alt="plot low discrepancy quadrature" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>           z0         z1         y0
count  100.000000 100.000000 100.000000
mean     0.488438   0.484856  -0.454770
std      0.288831   0.290073   0.199483
min      0.000000   0.000000  -0.803806
max      0.984375   0.987654   0.000000
</pre></div>
</div>
</section>
<section id="latin-hypercube-designs">
<h2>Latin Hypercube Designs<a class="headerlink" href="#latin-hypercube-designs" title="Permalink to this heading"></a></h2>
<p>Latin Hypercube designs are another popular means to compute low-discrepancy
samples for quadrature. Pyapprox does not support such designs as unlike
Sobol and Halton Sequences they are not nested. For example, when using Latin
Hypercube designs, it is not possible to requrest 100 samples
then request 200 samples while resuing the first 100.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.035 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-low-discrepancy-quadrature-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/0ab8cf693453cc1c9b15d4fe2f93dccc/plot_low_discrepancy_quadrature.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_low_discrepancy_quadrature.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/0879eb12822e0af4ff688a990073fe18/plot_low_discrepancy_quadrature.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_low_discrepancy_quadrature.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot_parameter_sweeps.html" class="btn btn-neutral float-left" title="Parameter Sweeps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plot_gaussian_quadrature.html" class="btn btn-neutral float-right" title="Univariate Gaussian Quadrature" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019 National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS). Under the terms of Contract DE-NA0003525 with NTESS, the U.S. Government retains certain rights in this software..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>